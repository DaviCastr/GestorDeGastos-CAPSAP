<<<<<<< HEAD
sap.ui.define(["sap/ui/core/Fragment","sap/ui/model/json/JSONModel"],function(e,a){"use strict";return{excluirTransacao:function(t){try{let t=sap.ui.core.Element.registry.filter(function(e){return e.isA("sap.m.Table")&&e.getId().includes("i18nTransaescompras-innerTable")});let o=t[0];let s=o.getSelectedItems()[0].getBindingContext().getValue();const r=this.getBindingContext().getValue();sap.ui.getCore().oFatura=r;const i=this.editFlow.getView();const c=i.getModel();if(s.ID){var n=function(){return new Promise(function(t,n){try{fetch(`${c.getServiceUrl()}Transacao?$filter=ID eq ${s.ID}`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(async function(o){console.log(o);let r=await o.json();let l=Array.isArray(r.value)?r.value:[r.value];if(!o.ok){throw new Error("Erro ao selecionar transações")}s=l[0];fetch(`${c.getServiceUrl()}Transacao?$filter=Identificador eq ${s.Identificador} and ID ne ${s.ID}`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(async function(n){console.log(n);let o=await n.json();let r=Array.isArray(o.value)?o.value:[o.value];r=r.sort(function(e,a){return a.Parcela-e.Parcela});let c={Dados:s,Fixo:s.ParcelasTotais==1&&r.length>0?true:false,Relacionadas:r};const l=new a(c);if(!sap.ui.getCore().pDialogExcluir){sap.ui.getCore().pDialogExcluir=e.load({id:"ExcluirTransacaoFragment",name:"apps.dflc.gestaogastos.ext.fragment.ExcluirTransacao"}).then(function(e){i.addDependent(e);return e})}sap.ui.getCore().pDialogExcluir.then(function(e){e.open();e.setModel(l,"Transacao")}.bind(this));t()}.bind(this)).catch(function(e){sap.m.MessageToast.show("Erro ao chamar serviço de Transações: "+e);n()})}.bind(this)).catch(function(e){sap.m.MessageToast.show("Erro ao chamar serviço de Transações: "+e);n()})}catch(e){sap.m.MessageToast.show("Erro ao chamar serviço: "+e.message)}}.bind(this))}.bind(this);let t={busy:{set:true,check:true},dataloss:{popup:true,navigation:false}};this.editFlow.securedExecution(n,t).finally(e=>{console.log(e)})}}catch(e){sap.m.MessageToast.show("Erro:"+e)}}}});
=======
sap.ui.define(["sap/m/MessageToast","sap/ui/core/Fragment","sap/ui/model/json/JSONModel"],function(e,a,t){"use strict";return{excluirTransacao:function(e){let n=sap.ui.core.Element.registry.filter(function(e){return e.isA("sap.m.Table")&&e.getId().includes("i18nTransaescompras-innerTable")});let o=n[0];let s=o.getSelectedItems()[0].getBindingContext().getValue();const i=this.getBindingContext().getValue();const r=this.editFlow.getView();if(s.ParcelasTotais>1){var c=()=>new Promise((e,n)=>{try{fetch(`/Gerenciamento/Transacao?$filter=ID eq ${s.ID}`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(async function(o){console.log(o);let i=await o.json();let c=Array.isArray(i.value)?i.value:[i.value];if(!o.ok){throw new Error("Erro ao selecionar transações")}s=c[0];fetch(`/Gerenciamento/Transacao?$filter=Identificador eq ${s.Identificador} and ID ne ${s.ID}`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(async function(n){console.log(n);let o=await n.json();let i=Array.isArray(o.value)?o.value:[o.value];i=i.sort(function(e,a){return a.Parcela-e.Parcela});let c={Dados:s,Relacionadas:i};const l=new t(c);r.setModel(l,"Transacao");if(!this.pDialog){this.pDialog=a.load({id:r.getId(),name:"apps.dflc.gestaogastos.ext.fragment.ExcluirTransacao"}).then(function(e){r.addDependent(e);return e})}this.pDialog.then(function(e){e.open()});e()}.bind(this)).catch(function(e){sap.m.MessageToast.show("Erro ao chamar serviço de Transações: "+e);n()})}.bind(this)).catch(function(e){sap.m.MessageToast.show("Erro ao chamar serviço de Transações: "+e);n()})}catch(e){sap.m.MessageToast.show("Erro ao chamar serviço: "+e.message)}});let e={busy:{set:true,check:true},dataloss:{popup:true,navigation:false}};this.editFlow.securedExecution(c,e).finally(e=>{console.log(e)})}else{let e={Dados:s,Relacionadas:[]};const n=new t(e);r.setModel(n,"Transacao");if(!this.pDialog){this.pDialog=a.load({id:r.getId(),name:"apps.dflc.gestaogastos.ext.fragment.ExcluirTransacao"}).then(function(e){r.addDependent(e);return e})}this.pDialog.then(function(e){e.open()})}}}});
>>>>>>> 7f01fe1936688df1011ce89337a57e281209142a
//# sourceMappingURL=ExcluirTransacao.js.map