sap.ui.define(["sap/m/MessageToast","sap/ui/model/json/JSONModel","sap/ui/core/Fragment"],function(e,t,a){"use strict";return{mudarCategoria:async function(i){try{let i=sap.ui.core.Element.registry.filter(function(e){return e.isA("sap.m.Table")&&e.getId().includes("i18nTransaescompras-innerTable")});let o=i[0];let r=o.getSelectedItems()[0].getBindingContext().getValue();const s=this.editFlow.getView();const n=s.getModel();let l=s.getBindingContext().getValue();sap.ui.getCore().oFatura=l;sap.ui.core.BusyIndicator.show();if(!l.Cartao_ID){let e=[new sap.ui.model.Filter("ID",sap.ui.model.FilterOperator.EQ,l.ID)];let t=await n.bindList(`/Fatura`,null,null,e).requestContexts();if(t.length>0){l=t[0].getObject();sap.ui.getCore().oFatura=l}}if(!r.Categoria_ID){let e=[new sap.ui.model.Filter("ID",sap.ui.model.FilterOperator.EQ,r.ID)];let t=await n.bindList(`/Transacao`,null,null,e).requestContexts();if(t.length>0){r=t[0].getObject()}}if(r.Categoria_ID){let e=[new sap.ui.model.Filter("ID",sap.ui.model.FilterOperator.EQ,r.Categoria_ID)];let i=`/Categoria`;n.bindList(`${i}`,null,null,e).requestContexts().then(async function(e){if(e.length>0){for(let i of e){i=i.getValue();let e=[new sap.ui.model.Filter("Pessoa_ID",sap.ui.model.FilterOperator.EQ,i.Pessoa_ID)];let o=`/Categoria`;let l=await n.bindList(`${o}`,null,null,e).requestContexts();r.Categoria=i;let u={Dados:r,Categorias:l.map(e=>e.getObject())};const d=new t(u);if(!sap.ui.getCore().pMudar){sap.ui.getCore().pMudar=a.load({id:"MudarCategoria",name:"apps.dflc.gestaogastos.ext.fragment.MudarCategoria"}).then(function(e){s.addDependent(e);return e})}sap.ui.getCore().pMudar.then(function(e){e.open();e.setModel(d,"TransacaoMudar");sap.ui.core.BusyIndicator.hide()}.bind(this))}}}.bind(this))}else{let i={};if(sap.ui.getCore().oCartao?.Pessoa_ID){i=sap.ui.getCore().oCartao}else{let e=[new sap.ui.model.Filter("ID",sap.ui.model.FilterOperator.EQ,l.Cartao_ID)];let t=await n.bindList(`/Cartao`,null,null,e).requestContexts();if(t.length>0){i=t[0].getObject()}}if(i.Pessoa_ID){let o={ID:"sem",Nome:"Sem categoria"};let l=[new sap.ui.model.Filter("Pessoa_ID",sap.ui.model.FilterOperator.EQ,i.Pessoa_ID)];let u=`/Categoria`;let d=await n.bindList(`${u}`,null,null,l).requestContexts();if(d.length==0){e.show("Não há categorias cadastradas.");sap.ui.core.BusyIndicator.hide();return}r.Categoria=o;let g={Dados:r,Categorias:d.map(e=>e.getObject())};const p=new t(g);if(!sap.ui.getCore().pMudar){sap.ui.getCore().pMudar=a.load({id:"MudarCategoria",name:"apps.dflc.gestaogastos.ext.fragment.MudarCategoria"}).then(function(e){s.addDependent(e);return e})}sap.ui.getCore().pMudar.then(function(e){e.open();e.setModel(p,"TransacaoMudar");sap.ui.core.BusyIndicator.hide()}.bind(this))}else{e.show("Erro ao buscar categoria");sap.ui.core.BusyIndicator.hide()}}}catch(t){e.show("Erro ao buscar categoria: "+t);sap.ui.core.BusyIndicator.hide()}}}});
//# sourceMappingURL=MudarCategoria.js.map