sap.ui.define(["sap/ui/core/mvc/ControllerExtension","sap/ui/core/message/Message","sap/ui/core/MessageType","apps/dflc/gestaogastos/ext/fragment/AnaliseCategoriaPessoa"],function(e,t,a,s){"use strict";return e.extend("apps.dflc.gestaogastos.ext.controller.PessoaObjeto",{defineAvisos:async function(e){setTimeout(async function(){if(this.getView().getModel("ui").getData().isEditable==false){let s=await e.requestObject(e.getPath());if(!s.ID){do{await this.wait();s=await e.requestObject(e.getPath())}while(!s.ID)}const i=this.base.getExtensionAPI();const o=[];let n=[new sap.ui.model.Filter("Pessoa_ID",sap.ui.model.FilterOperator.EQ,s.ID)];e.oModel.bindList("/Cartao",null,null,n).requestContexts().then(async function(e){if(e.length>0){let n=(new Date).toLocaleString("pt-BR",{timeZone:"America/Sao_Paulo"});n=n.replaceAll(","," ");let[r,l,c]=n.split(" ")[0].split("/");e.forEach(e=>{e=e.getValue();if(e.DiaVencimento-r>=0&&e.DiaVencimento-r<2){if(o.length==0){o.push(new t({type:a.Warning,message:`A fatura do cartão ${e.NomeCartao} está vencendo`}))}}});if(s.TotalDoMes>s.ObjetivoDeGasto&&o.length==0){o.push(new t({type:a.Warning,message:"Seu gasto está acima do seu objetivo de gasto mensal"}))}if(s.TotalDoMes>s.Renda&&o.length==0){o.push(new t({type:a.Warning,message:"Seu gasto está acima mensal está superior a sua renda, fique de olho e reduza seus gastos!"}))}i.showMessages(o)}})}}.bind(this),5e3)},sleep:function(e){return new Promise(t=>setTimeout(t,e))},wait:async function(){await this.sleep(500)},defineGraficoCategoriasTotalGastos:async function(e){s.defineGraficoCategoriasTotalGastos(this,e)},defineGraficoMensalCategorias:async function(e){s.defineGraficoMensalCategorias(this,e)},limpaPrevisao:async function(){let e=sap.ui.core.Element.registry.filter(function(e){try{return e.isA("sap.m.ObjectNumber")&&e.getId().includes("TotalDoMes")||e.isA("sap.m.ObjectNumber")&&e.getId().includes("TotalDeGastos")||e.isA("sap.m.ObjectNumber")&&e.getId().includes("ValorAEconomizar")}catch(e){}});if(e.length==0){do{await this.wait();e=sap.ui.core.Element.registry.filter(function(e){try{return e.isA("sap.m.ObjectNumber")&&e.getId().includes("TotalDoMes")||e.isA("sap.m.ObjectNumber")&&e.getId().includes("TotalDeGastos")||e.isA("sap.m.ObjectNumber")&&e.getId().includes("ValorAEconomizar")}catch(e){}})}while(e.length==0)}let t=sap.ui.core.Element.registry.filter(function(e){try{return e.isA("sap.m.FlexBox")&&e.getId().includes("categoryPrevisao")||e.isA("sap.m.FlexBox")&&e.getId().includes("categoryPrevisaoTotal")}catch(e){}});if(t.length==0){do{await this.wait();t=sap.ui.core.Element.registry.filter(function(e){try{return e.isA("sap.m.FlexBox")&&e.getId().includes("categoryPrevisao")||e.isA("sap.m.FlexBox")&&e.getId().includes("categoryPrevisaoTotal")}catch(e){}})}while(t.length==0)}e.forEach(e=>{e.setNumber("");e.setUnit("")});t.forEach(e=>{e.removeAllItems();e.addItem(new sap.m.Label({text:"Faça a pesquisa inicial"}))})},override:{onInit:async function(e){let t=[];t=sap.ui.core.Element.registry.filter(function(e){try{return e.isA("sap.m.Table")&&e.getId().includes("Cartes-innerTable")}catch(e){}});if(t.length==0){do{await this.wait();t=sap.ui.core.Element.registry.filter(function(e){try{return e.isA("sap.m.Table")&&e.getId().includes("Cartes-innerTable")}catch(e){}})}while(t.length==0)}t.forEach(e=>{e.getColumns().forEach(e=>{if(e.getHeader().getLabel().getText()=="Foto"){e.setImportance(sap.ui.core.Priority.High)}})})},routing:{onAfterBinding:async function(e){this.defineAvisos(e);this.defineGraficoCategoriasTotalGastos(e);this.defineGraficoMensalCategorias(e);this.limpaPrevisao()}}}})});
//# sourceMappingURL=PessoaObjeto.controller.js.map