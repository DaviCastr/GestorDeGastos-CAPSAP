sap.ui.define(["sap/m/MessageToast"],function(e){"use strict";return{defineCategoriasFaturaAtual:async function(e,t){try{let a=sap.ui.core.Element.registry.filter(function(e){return e.isA("sap.m.FlexBox")&&e.getId().includes("categoryCartao")});if(Array.isArray(a)){a.forEach(e=>{e.setBusy(true);e.removeAllItems()})}setTimeout(async function(){if(e){this.oCartaoController=e;this.oBindingContext=t}if(!this.oCartaoController){return}if(this.oCartaoController.getView().getModel("ui").getData().isEditable==false||null){if(!this.oBindingContext?.requestObject){return}let e=await this.oBindingContext.requestObject(this.oBindingContext.getPath());if(!e.ID){do{await this.oCartaoController.wait();e=await this.oBindingContext.requestObject(this.oBindingContext.getPath())}while(!e.ID)}sap.ui.getCore().oCartao=e;let t=(new Date).toLocaleString("pt-BR",{timeZone:"America/Sao_Paulo"});t=t.replaceAll(","," ");let[o,i,r]=t.split(" ")[0].split("/");o=Number(o);i=Number(i);r=Number(r);if(e.DiaFechamento>e.DiaVencimento){if(i==12){i=1;r+=1}else{i+=1}}if(e.DiaFechamento<=o){if(i==12){i=1;r+=1}else{i+=1}}let n=function(e,t){let a=sap.ui.core.Element.registry.filter(function(t){return t.isA("sap.m.FlexBox")&&t.getId().includes(`${e}`)});if(a.length>0){if(t?.Categorias){a=a[0];const e=[];t.Categorias.forEach(a=>{const o=a.TotalCategoria||0;const i=a.Porcentagem;const r=new sap.m.GenericTile({id:`Cartao::${a.ID}::${crypto.randomUUID()}`,headerImage:a.Imagem,header:a.Nome,subheader:`${o} ${t.Moeda}`,frameType:"OneByOne",tileContent:new sap.m.TileContent({footer:`Gasto: ${i.toFixed(2)}%`,content:new sap.suite.ui.microchart.RadialMicroChart({size:"Responsive",percentage:i,valueColor:i>20?"Error":"Good",alignContent:"Center"})})});e.push(r)});a.removeAllItems();if(e.length==0){a.addItem(new sap.m.Label({text:"Não há categorias com gastos nesse Mês"}))}else{e.forEach((t,o)=>{a.addItem(t);if(o<e.length-1){a.addItem(new sap.m.Label({text:"  --  "}))}})}a.setBusy(false)}else{a[0].removeAllItems();a[0].addItem(new sap.m.Label({text:"Não há categorias com gastos nesse Mês"}))}}}.bind(this);const s=this.oCartaoController.getView().getModel();let l="recuperaCategorias",c=s.bindContext(`/${l}(...)`);c.setParameter("cartao",e.ID);c.setParameter("mes",i);c.setParameter("ano",r);await c.execute();const m=c.getBoundContext().getValue();n("categoryCartao",m);if(Array.isArray(a)){a.forEach(e=>{e.setBusy(false)})}}}.bind(this),3e3)}catch(e){console.log("Erro:"+e)}}}});
//# sourceMappingURL=AnaliseCategoriaCartao.js.map