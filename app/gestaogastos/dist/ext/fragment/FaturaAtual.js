sap.ui.define(["sap/m/MessageToast","sap/ui/core/Fragment","sap/ui/model/json/JSONModel"],function(e,t,a){"use strict";return{onPress:function(t){e.show("Custom handler invoked.")},formatter:{formatDate:function(e){if(!e){return""}const t=new Date(`${e}T00:00:00`);const a=String(t.getDate()).padStart(2,"0");const n=String(t.getMonth()+1).padStart(2,"0");const s=t.getFullYear();return`${a}/${n}/${s}`}},excluirTransacao:async function(e){let n=sap.ui.core.Element.registry.filter(function(e){return e.isA("sap.ui.layout.form.SimpleForm")&&e.getId().includes("idFaturaForm")});let s=n[0];let o=sap.ui.core.Element.registry.filter(function(e){return e.isA("sap.m.Table")&&e.getId().includes("transactionsTable")});let i=o[0];const r=i.getSelectedItems();if(r.length===0){sap.m.MessageToast.show("Selecione uma transação para excluir.");return}let c=s.getBindingContext().getValue();let l=r[0].getBindingContext().getValue();const u=this._view;sap.ui.getCore().oFatura=c;if(l.ParcelasTotais>1){var d=()=>new Promise((e,n)=>{try{fetch(`/Gerenciamento/Transacao?$filter=Identificador eq ${l.Identificador} and ID ne ${l.ID}`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(async function(n){console.log(n);let s=await n.json();let o=Array.isArray(s.value)?s.value:[s.value];o=o.sort(function(e,t){return t.Parcela-e.Parcela});let i={Dados:l,Relacionadas:o};const r=new a(i);u.setModel(r,"Transacao");if(!this.pDialog){this.pDialog=t.load({id:u.getId(),name:"apps.dflc.gestaogastos.ext.fragment.ExcluirTransacao"}).then(function(e){u.addDependent(e);return e})}this.pDialog.then(function(e){e.open()});e()}.bind(this)).catch(function(e){sap.m.MessageToast.show("Erro ao chamar serviço de Transações: "+e);n()})}catch(e){sap.m.MessageToast.show("Erro ao chamar serviço: "+e.message)}});let e={busy:{set:true,check:true},dataloss:{popup:true,navigation:false}};this.editFlow.securedExecution(d,e).finally(e=>{console.log(e)})}else{let e={Dados:l,Relacionadas:[]};const n=new a(e);u.setModel(n,"Transacao");if(!this.pDialog){this.pDialog=t.load({id:u.getId(),name:"apps.dflc.gestaogastos.ext.fragment.ExcluirTransacao"}).then(function(e){u.addDependent(e);return e})}this.pDialog.then(function(e){e.open()})}},pesquisarTransacao:function(e){var t=[],a=e.getParameter("query");if(a&&a.length>0){t=[new Filter("Name",FilterOperator.Contains,a)]}const n=this._view.byId("transactionsTable").getBinding("items").filter(t,"Application")}}});
//# sourceMappingURL=FaturaAtual.js.map