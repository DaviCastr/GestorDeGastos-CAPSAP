sap.ui.define(["sap/m/MessageToast"],function(e){"use strict";return{excluirTransacao:function(e){var t=e.getSource().getParent();var n=this.getParent().getParent();var a=n.byId("idTransacao").getValue();var r=n.byId("identificadorTransacao").getValue();var s=n.byId("excluirTransacoesRelacionadas").getSelected();let o=sap.ui.core.Element.registry.filter(function(e){return e.isA("sap.m.Table")&&e.getId().includes("i18nTransaescompras-innerTable")});let i=o[0];var c={fatura:this.getBindingContext().getValue().ID,transacao:a,identificador:r,excluirRelacionadas:s};t.setBusy(true);var u=()=>new Promise((e,n)=>{fetch("/Gerenciamento",{method:"GET",headers:{"X-CSRF-Token":"Fetch"}}).then(function(e){if(!e.ok){throw new Error("Erro ao obter CSRF Token")}return e}.bind(this)).then(function(e){const t=e.headers.get("X-CSRF-Token");return t}.bind(this)).then(function(a){fetch("/Gerenciamento/excluirTransacao",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":a},body:JSON.stringify(c)}).then(function(e){if(!e.ok){throw new Error("Erro ao excluir transação.")}return e.json()}).then(function(n){let a=sap.ui.core.Element.registry.filter(function(e){return e.isA("sap.m.Table")&&e.getId().includes("innerTable")});let r=a[0];r.refreshItems();const s=this.getBindingContext();s.refresh();sap.m.MessageToast.show("Transação excluída com sucesso.");t.setBusy(false);t.close();i.getModel().refresh();e()}.bind(this)).catch(function(e){t.setBusy(false);sap.m.MessageToast.show("Erro: "+e.message);n()})}.bind(this)).catch(function(e){sap.m.MessageToast.show("Erro ao obter csrf token: "+e);n()})});let l={busy:{set:true,check:true},dataloss:{popup:true,navigation:false}};let d=this.getParent().getParent().getController().getExtensionAPI().getEditFlow();d.securedExecution(u,l).finally(e=>{console.log(e)})},cancelarExclusao:function(e){this.getParent().close()}}});
//# sourceMappingURL=ExcluirTransacao.js.map