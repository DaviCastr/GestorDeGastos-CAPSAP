sap.ui.define(["sap/m/MessageToast","sap/ui/core/util/File","sap/ui/core/Fragment","sap/ui/model/json/JSONModel"],function(e,t,a,o){"use strict";return{exportarBackup:async function(){var a=this.getParent();var o=this.getParent().getParent();a.close();var s=new sap.m.Dialog({title:"Exportar Backup",type:"Message",content:new sap.m.Text({text:"Gerando backup, aguarde..."})});s.setBusy(true);s.open();let r="exportarBackup";let n=o.getModel().bindContext(`/${r}(...)`);await n.execute();let i=n.getBoundContext();let c=i.getValue("value");s.close();if(c){const a=new Uint8Array(c.body.data);t.save(a,"backup-gestor-de-gastos","xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");e.show("Backup exportado com sucesso!")}else{e.show("Erro ao exportar backup!")}},importarBackup:async function(){const t=this.getParent().getParent();const o=this.getParent();const s=a.byId("Backup","fileUploader");const r=s.oFileUpload.files;sap.ui.core.BusyIndicator.show();if(!r||r.length===0){e.show("Por favor, selecione um arquivo.");sap.ui.core.BusyIndicator.hide();return}const n=r[0];const i=new FileReader;i.onload=async a=>{const s=a.target.result.split(",")[1];try{let a="importarBackup";let r=t.getModel().bindContext(`/${a}(...)`);r.setParameter("file",s);await r.execute();sap.ui.core.BusyIndicator.hide();o.setBusy(false);let n=r.getBoundContext();let i=n.getValue("value");o.close();if(i){const a=t.getModel();a.refresh();let o=sap.ui.core.Element.registry.filter(function(e){return e.isA("sap.m.Table")&&e.getId().includes("innerTable")});let s=o[0];s.refreshItems();let r=sap.ui.core.Element.registry.filter(function(e){return e.isA("sap.m.VBox")&&e.getId().includes("FaturaAtualVBox")});if(r.length){let e=r[0];e.getBindingContext().refresh()}e.show(i)}else{e.show("Erro ao importar backup!")}}catch(t){e.show("Erro ao importar o arquivo: "+t.message)}};i.readAsDataURL(n)},cancelarBackup:function(e){this.getParent().close()}}});
//# sourceMappingURL=Backup.js.map