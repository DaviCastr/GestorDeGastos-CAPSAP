sap.ui.define(["sap/m/MessageToast","sap/ui/core/Fragment"],function(e,t){"use strict";return{defineGraficoCategoriasTotalGastos:async function(e,t){let a=sap.ui.core.Element.registry.filter(function(e){return e.isA("sap.m.FlexBox")&&e.getId().includes("TotalGastosCharts")});a.forEach(e=>{e.setBusy(true);e.removeAllItems()});setTimeout(async function(){try{if(e){this.PessoaObjetoController=e;this.oBindingContext=t}if(!this.PessoaObjetoController){return}if(this.PessoaObjetoController.getView().getModel("ui").getData().isEditable==false){if(!this.oBindingContext?.requestObject){return}let e=await this.oBindingContext.requestObject(this.oBindingContext.getPath());if(!e.ID){do{await this.PessoaObjetoController.wait();e=await this.oBindingContext.requestObject(this.oBindingContext.getPath())}while(!e.ID)}let t=function(e,t){let a=sap.ui.core.Element.registry.filter(function(t){return t.isA("sap.m.FlexBox")&&t.getId().includes(`${e}`)});if(a.length>0){if(t?.Categorias){a=a[0];const e=[];t.Categorias.forEach(a=>{const o=a.TotalCategoria||0;const n=a.Porcentagem;const r=new sap.m.GenericTile({id:`Total::${a.ID}::${crypto.randomUUID()}`,headerImage:a.Imagem,header:a.Nome,subheader:`${o} ${t.Moeda}`,press:this.onPressTotal,frameType:"OneByOne",tileContent:new sap.m.TileContent({footer:`Gasto: ${n.toFixed(2)}%`,content:new sap.suite.ui.microchart.RadialMicroChart({size:"Responsive",percentage:n,valueColor:n>20?"Error":"Good",alignContent:"Center"})})});e.push(r)});a.removeAllItems();if(e.length==0){a.addItem(new sap.m.Label({text:"Não há categorias com gastos nesse Mês"}))}else{e.forEach((t,o)=>{a.addItem(t);if(o<e.length-1){a.addItem(new sap.m.Label({text:"  --  "}))}})}a.setBusy(false)}else{a[0].removeAllItems();a[0].addItem(new sap.m.Label({text:"Não há categorias com gastos nesse Mês"}))}}}.bind(this);let a=this.PessoaObjetoController.base.getExtensionAPI();let o=a.getModel();let n="recuperaCategoriasParaGastoTotal";let r=o.bindContext(`/${n}(...)`);r.setParameter("pessoa",e.ID);await r.execute();const s=r.getBoundContext().getValue();t("TotalGastosCharts",s)}}catch(e){console.log("Erro:"+e)}}.bind(this),2e3)},defineGraficoMensalCategorias:async function(e,t){try{let a=sap.ui.core.Element.registry.filter(function(e){return e.isA("sap.m.FlexBox")&&e.getId().includes("MensalCharts")});a.forEach(e=>{e.setBusy(true);e.removeAllItems()});setTimeout(async function(){if(e){this.PessoaObjetoController=e;this.oBindingContext=t}if(!this.PessoaObjetoController){return}if(this.PessoaObjetoController.getView().getModel("ui").getData().isEditable==false){if(!this.oBindingContext?.requestObject){return}let e=await this.oBindingContext.requestObject(this.oBindingContext.getPath());if(!e.ID){do{await this.PessoaObjetoController.wait();e=await this.oBindingContext.requestObject(this.oBindingContext.getPath())}while(!e.ID)}let t=function(e,t){let a=sap.ui.core.Element.registry.filter(function(t){return t.isA("sap.m.FlexBox")&&t.getId().includes(`${e}`)});if(a.length>0){if(t?.Categorias){a=a[0];const e=[];t.Categorias.forEach(a=>{const o=a.TotalCategoria||0;const n=a.Porcentagem;const r=new sap.m.GenericTile({id:`Total::${a.ID}::${crypto.randomUUID()}`,headerImage:a.Imagem,header:a.Nome,subheader:`${o} ${t.Moeda}`,press:this.onPressMensal,frameType:"OneByOne",tileContent:new sap.m.TileContent({footer:`Gasto: ${n.toFixed(2)}%`,content:new sap.suite.ui.microchart.RadialMicroChart({size:"Responsive",percentage:n,valueColor:n>20?"Error":"Good",alignContent:"Center"})})});e.push(r)});a.removeAllItems();if(e.length==0){a.addItem(new sap.m.Label({text:"Não há categorias com gastos nesse Mês"}))}else{e.forEach((t,o)=>{a.addItem(t);if(o<e.length-1){a.addItem(new sap.m.Label({text:"  --  "}))}})}a.setBusy(false)}else{a[0].removeAllItems();a[0].addItem(new sap.m.Label({text:"Não há categorias com gastos nesse Mês"}))}}}.bind(this);let a=this.PessoaObjetoController.base.getExtensionAPI();let o=a.getModel();let n="recuperaCategorias";let r=o.bindContext(`/${n}(...)`);r.setParameter("pessoa",e.ID);await r.execute();const s=r.getBoundContext().getValue();t("MensalCharts",s)}}.bind(this),2e3)}catch(e){console.log("Erro:"+e)}},onPressMensal:async function(a){try{const o=this.getParent().getParent().getParent().getParent().getParent().getParent().getParent().getParent().getParent().getParent(),n=this.getModel(),r=this.getBindingContext(),s=r.getObject(),i=a.getSource(),l=a.getSource().getId().split("::")[1];sap.ui.core.BusyIndicator.show();let d=function(e,t,a){const o=[];t.Cartoes.forEach((e,a)=>{let n=new sap.m.Panel({expandable:true,expanded:a==0?true:false,headerText:e.NomeCartao,width:"auto"});let r=new sap.m.Avatar({src:e.Imagem});n.addContent(r);let s=new sap.ui.layout.FixFlex;e.Faturas.sort((e,t)=>{const a=Number(e.Ano)-Number(t.Ano);if(a!==0){return a}return Number(e.Mes)-Number(t.Mes)});e.Faturas.forEach((e,a)=>{let o=new sap.m.Panel({expandable:true,expanded:a==0?true:false,headerText:`${e.Descricao}(${e.Mes}) de ${e.Ano}`,width:"auto"});o.addContent(new sap.m.Label({text:`Valor Total: ${e.ValorTotal} ${t.Moeda}`}));let n=new sap.ui.layout.FixFlex;e.Transacoes.sort((e,t)=>new Date(e.Data)-new Date(t.Data));for(const a of e.Transacoes){const e=new Date(`${a.Data}T00:00:00`);const o=e.getFullYear();const r=String(e.getMonth()+1).padStart(2,"0");const s=String(e.getDate()).padStart(2,"0");let i=new sap.m.Panel({expandable:true,expanded:false,headerText:`${a.Descricao}`,width:"auto"});let l=a?.ValorTotal||Number(a.Valor)*Number(a.ParcelasTotais);let d=new sap.m.VBox({items:[new sap.m.Label({text:`Data: ${s}/${r}/${o}`}),new sap.m.Label({text:`Total: ${l} ${t.Moeda}`}),new sap.m.Label({text:`Valor: ${a.Valor} ${t.Moeda}`}),new sap.m.Label({text:`Parcela: ${a.Parcela} de ${a.ParcelasTotais}`})]});i.addContent(d);n.addFixContent(i)}o.addContent(n);s.addFixContent(o)});n.addContent(s);o.push(n)});e.removeAllFixContent();e.addFixContent(new sap.m.VBox({alignItems:"Center",justifyContent:"Center",items:[new sap.m.GenericTile({headerImage:a.getHeaderImage(),header:a.getHeader(),subheader:a.getSubheader(),frameType:"OneByOne",tileContent:new sap.m.TileContent({footer:a.getTileContent()[0].getFooter(),content:new sap.suite.ui.microchart.RadialMicroChart({size:"Responsive",percentage:a.getTileContent()[0].getContent().getPercentage(),valueColor:a.getTileContent()[0].getContent().getValueColor(),alignContent:"Center"})})})]}));o.forEach((t,a)=>{e.addFixContent(t)})};let g="recuperaTransacoesPorCategoria",c=n.bindContext(`/${g}(...)`);c.setParameter("pessoa",s.ID);c.setParameter("categoria",l);await c.execute();const u=c.getBoundContext().getValue();if(u?.Cartoes){if(!t.byId("DetalhamentoCategoria","dialogTransacoesPorCategoria")){this._detalhamentoDialog=t.load({id:"DetalhamentoCategoria",name:"apps.dflc.gestaogastos.ext.fragment.TransacoesDaCategoria"}).then(function(e){o.addDependent(e);let a=t.byId("DetalhamentoCategoria","DetalhamentoCartoesCategoria");d(a,u,i);e.open();return e}.bind(this))}else{let e=t.byId("DetalhamentoCategoria","dialogTransacoesPorCategoria");let a=t.byId("DetalhamentoCategoria","DetalhamentoCartoesCategoria");d(a,u,i);e.open()}}else{e.show("Erro ao buscar informação:"+u)}sap.ui.core.BusyIndicator.hide()}catch(t){sap.ui.core.BusyIndicator.hide();e.show("Erro ao buscar informações:"+t)}},onPressTotal:async function(a){try{const o=this.getParent().getParent().getParent().getParent().getParent().getParent().getParent().getParent().getParent().getParent(),n=this.getModel(),r=this.getBindingContext(),s=r.getObject(),i=a.getSource(),l=a.getSource().getId().split("::")[1];sap.ui.core.BusyIndicator.show();let d=function(e,t,a){const o=[];t.Cartoes.forEach((e,a)=>{let n=new sap.m.Panel({expandable:true,expanded:a==0?true:false,headerText:e.NomeCartao,width:"auto"});let r=new sap.m.Avatar({src:e.Imagem});n.addContent(r);let s=new sap.ui.layout.FixFlex;e.Faturas.sort((e,t)=>{const a=Number(e.Ano)-Number(t.Ano);if(a!==0){return a}return Number(e.Mes)-Number(t.Mes)});e.Faturas.forEach((e,a)=>{let o=new sap.m.Panel({expandable:true,expanded:a==0?true:false,headerText:`${e.Descricao}(${e.Mes}) de ${e.Ano}`,width:"auto"});o.addContent(new sap.m.Label({text:`Valor Total: ${e.ValorTotal} ${t.Moeda}`}));let n=new sap.ui.layout.FixFlex;e.Transacoes.sort((e,t)=>new Date(e.Data)-new Date(t.Data));for(const a of e.Transacoes){const e=new Date(`${a.Data}T00:00:00`);const o=e.getFullYear();const r=String(e.getMonth()+1).padStart(2,"0");const s=String(e.getDate()).padStart(2,"0");let i=new sap.m.Panel({expandable:true,expanded:false,headerText:`${a.Descricao}`,width:"auto"});let l=a?.ValorTotal||Number(a.Valor)*Number(a.ParcelasTotais);let d=new sap.m.VBox({items:[new sap.m.Label({text:`Data: ${s}/${r}/${o}`}),new sap.m.Label({text:`Total: ${l} ${t.Moeda}`}),new sap.m.Label({text:`Valor: ${a.Valor} ${t.Moeda}`}),new sap.m.Label({text:`Parcela: ${a.Parcela} de ${a.ParcelasTotais}`})]});i.addContent(d);n.addFixContent(i)}o.addContent(n);s.addFixContent(o)});n.addContent(s);o.push(n)});e.removeAllFixContent();e.addFixContent(new sap.m.VBox({alignItems:"Center",justifyContent:"Center",items:[new sap.m.GenericTile({headerImage:a.getHeaderImage(),header:a.getHeader(),subheader:a.getSubheader(),frameType:"OneByOne",tileContent:new sap.m.TileContent({footer:a.getTileContent()[0].getFooter(),content:new sap.suite.ui.microchart.RadialMicroChart({size:"Responsive",percentage:a.getTileContent()[0].getContent().getPercentage(),valueColor:a.getTileContent()[0].getContent().getValueColor(),alignContent:"Center"})})})]}));o.forEach((t,a)=>{e.addFixContent(t)})};let g="recuperaTransacoesPorCategoria",c=n.bindContext(`/${g}(...)`);c.setParameter("pessoa",s.ID);c.setParameter("categoria",l);c.setParameter("total",true);await c.execute();const u=c.getBoundContext().getValue();if(u?.Cartoes){if(!t.byId("DetalhamentoCategoria","dialogTransacoesPorCategoria")){this._detalhamentoDialog=t.load({id:"DetalhamentoCategoria",name:"apps.dflc.gestaogastos.ext.fragment.TransacoesDaCategoria"}).then(function(e){o.addDependent(e);let a=t.byId("DetalhamentoCategoria","DetalhamentoCartoesCategoria");d(a,u,i);e.open();return e}.bind(this))}else{let e=t.byId("DetalhamentoCategoria","dialogTransacoesPorCategoria");let a=t.byId("DetalhamentoCategoria","DetalhamentoCartoesCategoria");d(a,u,i);e.open()}}else{e.show("Erro ao buscar informação:"+u)}sap.ui.core.BusyIndicator.hide()}catch(t){sap.ui.core.BusyIndicator.hide();e.show("Erro ao buscar informações:"+t)}},onPressPrevisao:async function(a,o,n){try{const r=a.getSource().getParent().getParent().getParent().getParent().getParent().getParent().getParent().getParent().getParent().getParent(),s=a.getSource().getModel(),i=a.getSource().getBindingContext(),l=i.getObject(),d=a.getSource(),g=a.getSource().getId().split("::")[1];sap.ui.core.BusyIndicator.show();let c=function(e,t,a){const o=[];t.Cartoes.forEach((e,a)=>{let n=new sap.m.Panel({expandable:true,expanded:a==0?true:false,headerText:e.NomeCartao,width:"auto"});let r=new sap.m.Avatar({src:e.Imagem});n.addContent(r);let s=new sap.ui.layout.FixFlex;e.Faturas.sort((e,t)=>{const a=Number(e.Ano)-Number(t.Ano);if(a!==0){return a}return Number(e.Mes)-Number(t.Mes)});e.Faturas.forEach((e,a)=>{let o=new sap.m.Panel({expandable:true,expanded:a==0?true:false,headerText:`${e.Descricao}(${e.Mes}) de ${e.Ano}`,width:"auto"});o.addContent(new sap.m.Label({text:`Valor Total: ${e.ValorTotal} ${t.Moeda}`}));let n=new sap.ui.layout.FixFlex;e.Transacoes.sort((e,t)=>new Date(e.Data)-new Date(t.Data));for(const a of e.Transacoes){const e=new Date(`${a.Data}T00:00:00`);const o=e.getFullYear();const r=String(e.getMonth()+1).padStart(2,"0");const s=String(e.getDate()).padStart(2,"0");let i=new sap.m.Panel({expandable:true,expanded:false,headerText:`${a.Descricao}`,width:"auto"});let l=a?.ValorTotal||Number(a.Valor)*Number(a.ParcelasTotais);let d=new sap.m.VBox({items:[new sap.m.Label({text:`Data: ${s}/${r}/${o}`}),new sap.m.Label({text:`Total: ${l} ${t.Moeda}`}),new sap.m.Label({text:`Valor: ${a.Valor} ${t.Moeda}`}),new sap.m.Label({text:`Parcela: ${a.Parcela} de ${a.ParcelasTotais}`})]});i.addContent(d);n.addFixContent(i)}o.addContent(n);s.addFixContent(o)});n.addContent(s);o.push(n)});e.removeAllFixContent();e.addFixContent(new sap.m.VBox({alignItems:"Center",justifyContent:"Center",items:[new sap.m.GenericTile({headerImage:a.getTileContent()[0].getContent().getItems()[0].getSrc(),header:a.getHeader(),subheader:a.getSubheader(),frameType:"OneByOne",tileContent:new sap.m.TileContent({footer:a.getTileContent()[0].getFooter(),content:new sap.suite.ui.microchart.RadialMicroChart({size:"Responsive",percentage:a.getTileContent()[0].getContent().getItems()[1].getPercentage(),valueColor:a.getTileContent()[0].getContent().getItems()[1].getValueColor(),alignContent:"Center"})})})]}));o.forEach((t,a)=>{e.addFixContent(t)})};let u="recuperaTransacoesPorCategoria",m=s.bindContext(`/${u}(...)`);m.setParameter("pessoa",l.ID);m.setParameter("categoria",g);m.setParameter("ano",o);m.setParameter("mes",n);await m.execute();const C=m.getBoundContext().getValue();if(C?.Cartoes){if(!t.byId("DetalhamentoCategoria","dialogTransacoesPorCategoria")){this._detalhamentoDialog=t.load({id:"DetalhamentoCategoria",name:"apps.dflc.gestaogastos.ext.fragment.TransacoesDaCategoria"}).then(function(e){r.addDependent(e);let a=t.byId("DetalhamentoCategoria","DetalhamentoCartoesCategoria");c(a,C,d);e.open();return e}.bind(this))}else{let e=t.byId("DetalhamentoCategoria","dialogTransacoesPorCategoria");let a=t.byId("DetalhamentoCategoria","DetalhamentoCartoesCategoria");c(a,C,d);e.open()}}else{e.show("Erro ao buscar informação:"+C)}sap.ui.core.BusyIndicator.hide()}catch(t){sap.ui.core.BusyIndicator.hide();e.show("Erro ao buscar informações:"+t)}},onPressPrevisaoTotal:async function(a,o,n){try{const r=a.getSource().getParent().getParent().getParent().getParent().getParent().getParent().getParent().getParent().getParent().getParent(),s=a.getSource().getModel(),i=a.getSource().getBindingContext(),l=i.getObject(),d=a.getSource(),g=a.getSource().getId().split("::")[1];sap.ui.core.BusyIndicator.show();let c=function(e,t,a){const o=[];t.Cartoes.forEach((e,a)=>{let n=new sap.m.Panel({expandable:true,expanded:a==0?true:false,headerText:e.NomeCartao,width:"auto"});let r=new sap.m.Avatar({src:e.Imagem});n.addContent(r);let s=new sap.ui.layout.FixFlex;e.Faturas.sort((e,t)=>{const a=Number(e.Ano)-Number(t.Ano);if(a!==0){return a}return Number(e.Mes)-Number(t.Mes)});e.Faturas.forEach((e,a)=>{let o=new sap.m.Panel({expandable:true,expanded:a==0?true:false,headerText:`${e.Descricao}(${e.Mes}) de ${e.Ano}`,width:"auto"});o.addContent(new sap.m.Label({text:`Valor Total: ${e.ValorTotal} ${t.Moeda}`}));let n=new sap.ui.layout.FixFlex;e.Transacoes.sort((e,t)=>new Date(e.Data)-new Date(t.Data));for(const a of e.Transacoes){const e=new Date(`${a.Data}T00:00:00`);const o=e.getFullYear();const r=String(e.getMonth()+1).padStart(2,"0");const s=String(e.getDate()).padStart(2,"0");let i=new sap.m.Panel({expandable:true,expanded:false,headerText:`${a.Descricao}`,width:"auto"});let l=a?.ValorTotal||Number(a.Valor)*Number(a.ParcelasTotais);let d=new sap.m.VBox({items:[new sap.m.Label({text:`Data: ${s}/${r}/${o}`}),new sap.m.Label({text:`Total: ${l} ${t.Moeda}`}),new sap.m.Label({text:`Valor: ${a.Valor} ${t.Moeda}`}),new sap.m.Label({text:`Parcela: ${a.Parcela} de ${a.ParcelasTotais}`})]});i.addContent(d);n.addFixContent(i)}o.addContent(n);s.addFixContent(o)});n.addContent(s);o.push(n)});e.removeAllFixContent();e.addFixContent(new sap.m.VBox({alignItems:"Center",justifyContent:"Center",items:[new sap.m.GenericTile({headerImage:a.getTileContent()[0].getContent().getItems()[0].getSrc(),header:a.getHeader(),subheader:a.getSubheader(),frameType:"OneByOne",tileContent:new sap.m.TileContent({footer:a.getTileContent()[0].getFooter(),content:new sap.suite.ui.microchart.RadialMicroChart({size:"Responsive",percentage:a.getTileContent()[0].getContent().getItems()[1].getPercentage(),valueColor:a.getTileContent()[0].getContent().getItems()[1].getValueColor(),alignContent:"Center"})})})]}));o.forEach((t,a)=>{e.addFixContent(t)})};let u="recuperaTransacoesPorCategoria",m=s.bindContext(`/${u}(...)`);m.setParameter("pessoa",l.ID);m.setParameter("categoria",g);m.setParameter("total",true);m.setParameter("ano",o);m.setParameter("mes",n);await m.execute();const C=m.getBoundContext().getValue();if(C?.Cartoes){if(!t.byId("DetalhamentoCategoria","dialogTransacoesPorCategoria")){this._detalhamentoDialog=t.load({id:"DetalhamentoCategoria",name:"apps.dflc.gestaogastos.ext.fragment.TransacoesDaCategoria"}).then(function(e){r.addDependent(e);let a=t.byId("DetalhamentoCategoria","DetalhamentoCartoesCategoria");c(a,C,d);e.open();return e}.bind(this))}else{let e=t.byId("DetalhamentoCategoria","dialogTransacoesPorCategoria");let a=t.byId("DetalhamentoCategoria","DetalhamentoCartoesCategoria");c(a,C,d);e.open()}}else{e.show("Erro ao buscar informação:"+C)}sap.ui.core.BusyIndicator.hide()}catch(t){sap.ui.core.BusyIndicator.hide();e.show("Erro ao buscar informações:"+t)}}}});
//# sourceMappingURL=AnaliseCategoriaPessoa.js.map